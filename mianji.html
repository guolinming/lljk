<!DOCTYPE html>
<html>
<head>
    <title>报表</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
</head>
<body>
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<select id="classType">

</select>

<div id="main" style="height:700px;"></div>
<!-- ECharts单文件引入 -->
<script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
<script src="http://echarts.baidu.com/build/dist/chart/line.js"></script>
<script src="./plugin/data/data.js"></script>
<script src="./plugin/data/data2.js"></script>
<script src="./plugin/jquery/jquery.min.js"></script>
<script src="./plugin/util/dateformat.js"></script>
<script type="text/javascript">
    $('#classType').change(function(){
        var a = $('#classType').val();
        load(a);
        myChart.refresh();
    });
    $(document).ready(function () {
        load(0);
    })
    $('#main').css('height', $(window).height() * 0.7);

    //调用方法
    var classtypeHtml = ""
    $.each(dataObj.data, function (idx, item) {
        classtypeHtml += "<option value='" + idx + "' >" + item[0] + "</option>"
    });
    $('#classType').html(classtypeHtml);

    // 路径配置
    require.config({
        paths: {
            echarts: 'http://echarts.baidu.com/build/dist'
        }
    });
    var myChart;
    function load(index) {
        var max = dataObj.max;
        var items_name = new Array();
        var x_value = new Array();
        var series = new Array();
        $.each(dataObj.data, function (idx, item) {
            if (index == idx) {
                items_name.push(item[0]);
                var serie;
                var y_value = new Array();
                $.each(item[1], function (idx2, item2) {
                    if (idx == index) {
                        var time = new Date(item2[0]);
                        var dt = time.format("hh:mm");
                        x_value.push(dt);
                    }
                    var yv = item2[1];
                    y_value.push(yv);
                });
                serie = {
                    name: item[0],
                    type: 'line',
                    smooth: true,
                    itemStyle: {normal: {areaStyle: {type: 'default'}}},
                    data: y_value};
                series.push(serie);
            }
        });
        // 使用
        require(
                [
                    'echarts',
                    'echarts/chart/line' // 使用柱状图就加载bar模块，按需加载
                ],
                function (ec) {
                    // 基于准备好的dom，初始化echarts图表
                    myChart = ec.init(document.getElementById('main'));
                    var option = {
                        title: {
                            text: 'TOP10协议',
                            subtext: '',
                            x: 'center',
                            textStyle: {fontSize: 20, fontStyle: 'italic'}
                        },
                        tooltip: {
                            trigger: 'axis'
                        },
                        grid:{
                            x:60,
                            x2:5
                        },
//                    legend: {
//                        textStyle: {fontSize: 20, fontStyle: 'italic'},
//                        data: items_name,
//                        y: 'bottom',
//                        x: 'left',
//                        borderWidth: 2
//                    },
                        xAxis: [
                            {
//                                axisLabel: {textStyle: {fontSize: 12}},
                                type: 'category',
                                boundaryGap: false,
                                axisLine: {onZero: false},
                                data: x_value
                            }
                        ],
                        yAxis: [
                            {
                                axisLabel: {rotate: 70},
                                name: '流量',
                                nameTextStyle: {fontSize: 12},
                                type: 'value',
                                max: max
                            }
                        ],
                        series: series
                    };

                    // 为echarts对象加载数据
                    myChart.setOption(option);

                }
        );
    }


</script>
</body>
</html>